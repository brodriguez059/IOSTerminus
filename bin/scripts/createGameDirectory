#!/bin/bash

# Website used to generate the random names:
# https://www.fantasynamegenerators.com

basePath="$PWD/data/Home"
descriptionFile=".description"

createGameDirectory() {
    #echo "Deleting $basePath and all its content..."
    rm -R $basePath > /dev/null 2>&1

    # Home
    #echo "Recreating..."
    mkdir -p $basePath
    cd $basePath
    echo "This small house looks very old-fashioned and is in average condition. " > $descriptionFile
    echo "Wait... this is my house!" >> $descriptionFile

    # >bed
    echo "Seems comfy but I have rest enough for today... Maybe I should explore the surroundings" > "bed"
    # >diary
    echo "`date --date="yesterday" +"%A, %dth %B %Y"`:" >> "diary"
    echo "It's been some days since the last entry..." >> "diary"
    echo "`date --date="7 days ago" +"%A, %dth %B %Y"`:" >> "diary"
    echo "Today is my birthday! Grandma has done a cheese cake specially for me it tasted tremendously good. I have to ask her the recipe and learn to make it as she makes, best cake ever!!!" >> "diary"
    echo "`date --date="8 days ago" +"%A, %dth %B %Y"`:" >> "diary"
    echo "Tomorrow is my birthday, I'm so excited! Grandma told me that she has prepared a special present for the occasion. Worst thing is she has not given me any clue. I don't have any idea what could it be. Also it's been long since the last time I saw her, I think it's been over a month ago..." >> "diary"
    echo "" >> "diary"
    echo "* Closes the diary... *" >> "diary"
    echo "It continues several pages, I don't feel to know more about myself now." >> "diary"

    # Home/Valley
    mkdir "$basePath/Valley"
    cd "$basePath/Valley"
    echo "TODO Valley" > $descriptionFile

    # >ancient_sign
    echo "There are instructions to discover new places written in it." > "ancient_sign"
    # >flower
    echo "A beautiful tulip, there are bees in it. I am not gonna risk in taking it as they might sting me." > "flower"

    # Home/Forest
    mkdir "$basePath/Forest"
    cd "$basePath/Forest"
    echo "TODO Forest" > $descriptionFile

    # >sign
    echo "At the left a bog at the right the town and in the middle the lake were sometimes a liquid that's not water is found." >> "sign"
    echo "If the magic book you must find, first the boat you'll have to repair." >> "sign"
    echo "Try not to enter the bog, it smells... funky." >> "sign"

    # Home/Forest/Bog
    mkdir "$basePath/Forest/Bog"
    cd "$basePath/Forest/Bog"
    echo "TODO Bog" > $descriptionFile

    # Home/Forest/Small_lake
    mkdir "$basePath/Forest/Small_lake"
    cd "$basePath/Forest/Small_lake"
    echo "TODO Small lake" > $descriptionFile
    # >broken boat
    echo "It's broken. Only if I could connect it with something else..." > "broken_boat"

    # Home/Forest/Small_lake/Small_island
    mkdir "$basePath/Forest/Small_lake/Small_island"
    cd "$basePath/Forest/Small_lake/Small_island"
    echo "TODO Small island" > $descriptionFile

    # >spell_book
    echo "It has some writtings in it, maybe they could be learnt in a Study Room..." > "spell_book"

    # Home/Forest/town
    mkdir "$basePath/Forest/Town"
    cd "$basePath/Forest/Town"
    echo "TODO Town" > $descriptionFile

    # >sign
    echo "Welcome to Blisey: where everyone knows magic but no one will admit it." >> "sign"
    echo "" >> "sign"
    echo "Students please go directly to the Magic Tower after unpacking all your belongings. Lessons start everyday at 7 am in the 'Lesson' room, you have a 24/7 room available for any needs you can find. Feel free to join it with any other students in the 'Study room'." >> "sign"
    # >Townspeople, each file is a different person
    echo "Who are you?" > "Hronar"
    echo "I'm late for todays classes" > "Hidi"
    echo "Welcome new traveller! Feel free to join one of the classes on the 'Magic tower' whenever you fill ready to learn new powers" > "Siraye_Arazana"
    echo "Welcome to our humble town traveller" > "Zemra"

    # Home/Forest/Town/Mountain
    mkdir "$basePath/Forest/Town/Mountain"
    cd "$basePath/Forest/Town/Mountain"
    echo "TODO Mountain" > $descriptionFile
    # >boulder
    echo "Seems granite, but I'm not a gemmologist so it could be any other type..." > "boulder"

    # Home/Forest/Town/Mountain/Cliff
    mkdir "$basePath/Forest/Town/Mountain/Cliff"
    cd "$basePath/Forest/Town/Mountain/Cliff"
    touch ".gitkeep"

    # Home/Forest/Town/Mountain/Cave_entrance
    mkdir "$basePath/Forest/Town/Mountain/Cave_entrance"
    cd "$basePath/Forest/Town/Mountain/Cave_entrance"
    echo "TODO Cave entrance" >> $descriptionFile

    # Home/Forest/Town/Mountain/Cave_entrance/Cave(west)
    mkdir "$basePath/Forest/Town/Mountain/Cave_entrance/Cave(west)"
    cd "$basePath/Forest/Town/Mountain/Cave_entrance/Cave(west)"
    echo "TODO Cave(west)" > $descriptionFile
    # >foul_goblin
    echo "It really complies the definition of foul..." > "foul_goblin"

    # Home/Forest/Town/Mountain/Cave_entrance/Cave(east)
    mkdir "$basePath/Forest/Town/Mountain/Cave_entrance/Cave(east)"
    cd "$basePath/Forest/Town/Mountain/Cave_entrance/Cave(east)"
    echo "TODO Cave(east)" > $descriptionFile
    # >big_orc
    echo "I cannot defeat him by me alone, I'll have to trick him into something in order to defeat him..." > "big_orc"

    # Home/Forest/Town/Mountain/Cave_entrance/Cave(east)/Big_hole
    mkdir "$basePath/Forest/Town/Mountain/Cave_entrance/Cave(east)/Big_hole"
    cd "$basePath/Forest/Town/Mountain/Cave_entrance/Cave(east)/Big_hole"
    touch ".gitkeep"

    # Home/Forest/Town/Magic_tower
    mkdir "$basePath/Forest/Town/Magic_tower"
    echo "TODO Magic Tower" > $descriptionFile

    # Home/Forest/Town/Magic_tower/Lesson_room
    mkdir "$basePath/Forest/Town/Magic_tower/Lesson_room"
    cd "$basePath/Forest/Town/Magic_tower/Lesson_room"
    echo "TODO Lesson Room" > $descriptionFile

    # Home/Forest/Town/Magic_tower/Study_Room
    mkdir "$basePath/Forest/Town/Magic_tower/Study_Room"
    cd "$basePath/Forest/Town/Magic_tower/Study_Room"
    echo "TODO Study Room" > $descriptionFile

    #echo "Done!"
}

if [ $# -ne 1 ]
then
    read -p "This will delete the directory $basePath and all its content, do you wish to continue? [y/n] " yn
    echo
    echo "TIP: you can also pass the confirmation as a parameter to bypass the request, example of confirmation:"
    echo "   $ ./$0 y"
    echo
else
    yn=$1
fi

while true
do
    case $yn in
        [Yy]* )
        createGameDirectory
        exit
        ;;
        [Nn]* )
        echo "Canceled, exiting..."
        exit
        ;;
        * )
        read -p "Please answer with y (yes) or n (no). [y/n] " yn
    esac
done
